


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > ArrayBuilders</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.fasterxml.jackson.databind.util</a>
</div>

<h1>Coverage Summary for Class: ArrayBuilders (com.fasterxml.jackson.databind.util)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">ArrayBuilders</td>
<td class="coverageStat">
  <span class="percent">
    64.3%
  </span>
  <span class="absValue">
    (9/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    64.9%
  </span>
  <span class="absValue">
    (50/77)
  </span>
</td>
</tr>
  <tr>
    <td class="name">ArrayBuilders$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    84.6%
  </span>
  <span class="absValue">
    (11/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$BooleanBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$ByteBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$DoubleBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$FloatBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$IntBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$LongBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ArrayBuilders$ShortBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    83.3%
  </span>
  <span class="absValue">
    (25/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    72.1%
  </span>
  <span class="absValue">
    (75/104)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.fasterxml.jackson.databind.util;
&nbsp;
&nbsp;import java.lang.reflect.Array;
&nbsp;import java.util.*;
&nbsp;
&nbsp;/**
&nbsp; * Helper class that contains set of distinct builders for different
&nbsp; * arrays of primitive values. It also provides trivially simple
&nbsp; * reuse scheme, which assumes that caller knows not to use instances
&nbsp; * concurrently (which works ok with primitive arrays since they can
&nbsp; * not contain other non-primitive types).
&nbsp; * Also note that instances are not thread safe; the intent is that
&nbsp; * a builder is constructed on per-call (deserialization) basis.
&nbsp; */
&nbsp;public final class ArrayBuilders
&nbsp;{
<b class="fc">&nbsp;    private BooleanBuilder _booleanBuilder = null;</b>
&nbsp;
&nbsp;    // note: no need for char[] builder, assume they are Strings
&nbsp;
<b class="fc">&nbsp;    private ByteBuilder _byteBuilder = null;</b>
<b class="fc">&nbsp;    private ShortBuilder _shortBuilder = null;</b>
<b class="fc">&nbsp;    private IntBuilder _intBuilder = null;</b>
<b class="fc">&nbsp;    private LongBuilder _longBuilder = null;</b>
&nbsp;    
<b class="fc">&nbsp;    private FloatBuilder _floatBuilder = null;</b>
<b class="fc">&nbsp;    private DoubleBuilder _doubleBuilder = null;</b>
&nbsp;
<b class="fc">&nbsp;    public ArrayBuilders() { }</b>
&nbsp;
&nbsp;    public BooleanBuilder getBooleanBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_booleanBuilder == null) {</b>
<b class="fc">&nbsp;            _booleanBuilder = new BooleanBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _booleanBuilder;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ByteBuilder getByteBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_byteBuilder == null) {</b>
<b class="fc">&nbsp;            _byteBuilder = new ByteBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _byteBuilder;</b>
&nbsp;    }
&nbsp;    public ShortBuilder getShortBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_shortBuilder == null) {</b>
<b class="fc">&nbsp;            _shortBuilder = new ShortBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _shortBuilder;</b>
&nbsp;    }
&nbsp;    public IntBuilder getIntBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_intBuilder == null) {</b>
<b class="fc">&nbsp;            _intBuilder = new IntBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _intBuilder;</b>
&nbsp;    }
&nbsp;    public LongBuilder getLongBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_longBuilder == null) {</b>
<b class="fc">&nbsp;            _longBuilder = new LongBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _longBuilder;</b>
&nbsp;    }
&nbsp;
&nbsp;    public FloatBuilder getFloatBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_floatBuilder == null) {</b>
<b class="fc">&nbsp;            _floatBuilder = new FloatBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _floatBuilder;</b>
&nbsp;    }
&nbsp;    public DoubleBuilder getDoubleBuilder()
&nbsp;    {
<b class="fc">&nbsp;        if (_doubleBuilder == null) {</b>
<b class="fc">&nbsp;            _doubleBuilder = new DoubleBuilder();</b>
&nbsp;        }
<b class="fc">&nbsp;        return _doubleBuilder;</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;    /**********************************************************
&nbsp;    /* Impl classes
&nbsp;    /**********************************************************
&nbsp;     */
&nbsp;
&nbsp;    public final static class BooleanBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;boolean[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public BooleanBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final boolean[] _constructArray(int len) { return new boolean[len]; }</b>
&nbsp;    }
&nbsp;
&nbsp;    public final static class ByteBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;byte[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public ByteBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final byte[] _constructArray(int len) { return new byte[len]; }</b>
&nbsp;    }
&nbsp;    public final static class ShortBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;short[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public ShortBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final short[] _constructArray(int len) { return new short[len]; }</b>
&nbsp;    }
&nbsp;    public final static class IntBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;int[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public IntBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final int[] _constructArray(int len) { return new int[len]; }</b>
&nbsp;    }
&nbsp;    public final static class LongBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;long[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public LongBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final long[] _constructArray(int len) { return new long[len]; }</b>
&nbsp;    }
&nbsp;
&nbsp;    public final static class FloatBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;float[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public FloatBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final float[] _constructArray(int len) { return new float[len]; }</b>
&nbsp;    }
&nbsp;    public final static class DoubleBuilder
&nbsp;        extends PrimitiveArrayBuilder&lt;double[]&gt;
&nbsp;    {
<b class="fc">&nbsp;        public DoubleBuilder() { }</b>
&nbsp;        @Override
<b class="fc">&nbsp;        public final double[] _constructArray(int len) { return new double[len]; }</b>
&nbsp;    }
&nbsp;    
&nbsp;    /*
&nbsp;    /**********************************************************
&nbsp;    /* Static helper methods
&nbsp;    /**********************************************************
&nbsp;     */
&nbsp;
&nbsp;    /**
&nbsp;     * Helper method used for constructing simple value comparator used for
&nbsp;     * comparing arrays for content equality.
&nbsp;     *&lt;p&gt;
&nbsp;     * Note: current implementation is not optimized for speed; if performance
&nbsp;     * ever becomes an issue, it is possible to construct much more efficient
&nbsp;     * typed instances (one for Object[] and sub-types; one per primitive type).
&nbsp;     * 
&nbsp;     * @since 2.2 Moved from earlier &lt;code&gt;Comparators&lt;/code&gt; class
&nbsp;     */
&nbsp;    public static Object getArrayComparator(final Object defaultValue)
&nbsp;    {
<b class="fc">&nbsp;        final int length = Array.getLength(defaultValue);</b>
<b class="fc">&nbsp;        final Class&lt;?&gt; defaultValueType = defaultValue.getClass();</b>
<b class="fc">&nbsp;        return new Object() {</b>
&nbsp;            @Override
&nbsp;            public boolean equals(Object other) {
<b class="fc">&nbsp;                if (other == this) return true;</b>
<b class="fc">&nbsp;                if (other == null || other.getClass() != defaultValueType) {</b>
<b class="nc">&nbsp;                    return false;</b>
&nbsp;                }
<b class="fc">&nbsp;                if (Array.getLength(other) != length) return false;</b>
&nbsp;                // so far so good: compare actual equality; but only shallow one
<b class="fc">&nbsp;                for (int i = 0; i &lt; length; ++i) {</b>
<b class="fc">&nbsp;                    Object value1 = Array.get(defaultValue, i);</b>
<b class="fc">&nbsp;                    Object value2 = Array.get(other, i);</b>
<b class="fc">&nbsp;                    if (value1 == value2) continue;</b>
<b class="fc">&nbsp;                    if (value1 != null) {</b>
<b class="fc">&nbsp;                        if (!value1.equals(value2)) {</b>
<b class="nc">&nbsp;                            return false;</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
<b class="fc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;        };
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; HashSet&lt;T&gt; arrayToSet(T[] elements)
&nbsp;    {
<b class="nc">&nbsp;        HashSet&lt;T&gt; result = new HashSet&lt;T&gt;();</b>
<b class="nc">&nbsp;        if (elements != null) {</b>
<b class="nc">&nbsp;            for (T elem : elements) {</b>
<b class="nc">&nbsp;                result.add(elem);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; ArrayList&lt;T&gt; arrayToList(T[] elements)
&nbsp;    {
<b class="nc">&nbsp;        ArrayList&lt;T&gt; result = new ArrayList&lt;T&gt;();</b>
<b class="nc">&nbsp;        if (elements != null) {</b>
<b class="nc">&nbsp;            for (T elem : elements) {</b>
<b class="nc">&nbsp;                result.add(elem);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    public static &lt;T&gt; HashSet&lt;T&gt; setAndArray(Set&lt;T&gt; set, T[] elements)
&nbsp;    {
<b class="nc">&nbsp;        HashSet&lt;T&gt; result = new HashSet&lt;T&gt;();</b>
<b class="nc">&nbsp;        if (set != null) {</b>
<b class="nc">&nbsp;            result.addAll(set);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (elements != null) {</b>
<b class="nc">&nbsp;            for (T value : elements) {</b>
<b class="nc">&nbsp;                result.add(value);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Helper method for adding specified element to a List, but also
&nbsp;     * considering case where the List may not have been yet constructed
&nbsp;     * (that is, null is passed instead).
&nbsp;     * 
&nbsp;     * @param list List to add to; may be null to indicate that a new
&nbsp;     *    List is to be constructed
&nbsp;     * @param element Element to add to list
&nbsp;     * 
&nbsp;     * @return List in which element was added; either &lt;code&gt;list&lt;/code&gt;
&nbsp;     *   (if it was not null), or a newly constructed List.
&nbsp;     */
&nbsp;    public static &lt;T&gt; List&lt;T&gt; addToList(List&lt;T&gt; list, T element)
&nbsp;    {
<b class="nc">&nbsp;        if (list == null) {</b>
<b class="nc">&nbsp;            list = new ArrayList&lt;T&gt;();</b>
&nbsp;        }
<b class="nc">&nbsp;        list.add(element);</b>
<b class="nc">&nbsp;        return list;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Helper method for constructing a new array that contains specified
&nbsp;     * element followed by contents of the given array. No checking is done
&nbsp;     * to see if element being inserted is duplicate.
&nbsp;     */
&nbsp;    public static &lt;T&gt; T[] insertInList(T[] array, T element)
&nbsp;    {
<b class="nc">&nbsp;        int len = array.length;</b>
&nbsp;        @SuppressWarnings(&quot;unchecked&quot;)
<b class="nc">&nbsp;        T[] result = (T[]) Array.newInstance(array.getClass().getComponentType(), len+1);</b>
<b class="nc">&nbsp;        if (len &gt; 0) {</b>
<b class="nc">&nbsp;            System.arraycopy(array, 0, result, 1, len);</b>
&nbsp;        }
<b class="nc">&nbsp;        result[0] = element;</b>
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Helper method for constructing a new array that contains specified
&nbsp;     * element followed by contents of the given array but never contains
&nbsp;     * duplicates.
&nbsp;     * If element already existed, one of two things happens: if the element
&nbsp;     * was already the first one in array, array is returned as is; but
&nbsp;     * if not, a new copy is created in which element has moved as the head.
&nbsp;     */
&nbsp;    @SuppressWarnings(&quot;unchecked&quot;)
&nbsp;    public static &lt;T&gt; T[] insertInListNoDup(T[] array, T element)
&nbsp;    {
<b class="fc">&nbsp;        final int len = array.length;</b>
&nbsp;        
&nbsp;        // First: see if the element already exists
<b class="fc">&nbsp;        for (int ix = 0; ix &lt; len; ++ix) {</b>
<b class="fc">&nbsp;            if (array[ix] == element) {</b>
&nbsp;                // if at head already, return as is
<b class="fc">&nbsp;                if (ix == 0) {</b>
<b class="fc">&nbsp;                    return array;</b>
&nbsp;                }
&nbsp;                // otherwise move things around
<b class="fc">&nbsp;                T[] result = (T[]) Array.newInstance(array.getClass().getComponentType(), len);</b>
<b class="fc">&nbsp;                System.arraycopy(array, 0, result, 1, ix);</b>
<b class="fc">&nbsp;                result[0] = element;</b>
<b class="fc">&nbsp;                ++ix;</b>
<b class="fc">&nbsp;                int left = len - ix;</b>
<b class="fc">&nbsp;                if (left &gt; 0) {</b>
<b class="fc">&nbsp;                	System.arraycopy(array, ix, result, ix, left);</b>
&nbsp;                }
<b class="fc">&nbsp;                return result;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        // but if not, allocate new array, move
<b class="fc">&nbsp;        T[] result = (T[]) Array.newInstance(array.getClass().getComponentType(), len+1);</b>
<b class="fc">&nbsp;        if (len &gt; 0) {</b>
<b class="fc">&nbsp;            System.arraycopy(array, 0, result, 1, len);</b>
&nbsp;        }
<b class="fc">&nbsp;        result[0] = element;</b>
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-04-04 11:14</div>
</div>
</body>
</html>
